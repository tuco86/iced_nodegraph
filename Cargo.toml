[package]
name = "iced_nodegraph"
version = "0.1.0"
edition = "2024"

[lib]
crate-type = ["cdylib", "rlib"]

[features]
default = []
wasm = [
    "wasm-bindgen", 
    "web-sys", 
    "console_error_panic_hook",
    "wasm-bindgen-futures",
    "serde",
    "serde_json"
]

[dependencies]
euclid = { version = "0.22.11", features = [ "bytemuck" ] }
bytemuck = { version = "1.24.0", features = ["derive"] }
glam = { version = "0.25.0", features = ["bytemuck"] }
iced = { git = "https://github.com/iced-rs/iced.git", branch = "master" }
iced_wgpu = { git = "https://github.com/iced-rs/iced.git", branch = "master" }
iced_widget = { git = "https://github.com/iced-rs/iced.git", branch = "master" }

# WGPU with WebGPU backend for WASM
[target.'cfg(target_arch = "wasm32")'.dependencies]
wgpu = { version = "27.0", features = ["webgpu", "webgl"] }

# Force newer versions to reduce duplicates where possible
# Note: Some duplicates remain due to external dependencies (winit fork, WGPU stack)
bitflags = "2.10"
thiserror = "2.0"
rustc-hash = "2.1"

# WASM-specific dependencies (optional)
wasm-bindgen = { version = "0.2", optional = true }
web-sys = { version = "0.3", features = ["Window", "Document", "HtmlCanvasElement", "WebGl2RenderingContext", "Gpu", "GpuAdapter", "GpuDevice"], optional = true }
[dependencies.wasm-bindgen-futures]
version = "0.4"
optional = true

[dependencies.console_error_panic_hook]
version = "0.1"
optional = true

[dependencies.serde]
version = "1.0"
features = ["derive"]
optional = true

[dependencies.serde_json]
version = "1.0"
optional = true
